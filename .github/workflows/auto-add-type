name: Assign Fields Based on Title

on:
  issues:
    types: [opened, edited, reopened]
  pull_request:
    types: [opened, edited, reopened]

jobs:
  assign-fields:
    runs-on: ubuntu-latest
    steps:
      # Step 1: Extract title
      - name: Extract Title
        id: extract-title
        run: |
          if [ "${{ github.event_name }}" == "issues" ]; then
            echo "title=${{ github.event.issue.title }}" >> $GITHUB_ENV
          elif [ "${{ github.event_name }}" == "pull_request" ]; then
            echo "title=${{ github.event.pull_request.title }}" >> $GITHUB_ENV
          fi

      # Step 2: Determine Field Value
      - name: Determine Field
        id: determine-field
        run: |
          case "${{ env.title }}" in
            feat:*) echo "field=feature ðŸ› " >> $GITHUB_ENV ;;
            fix:*) echo "field=bug fix ðŸ›" >> $GITHUB_ENV ;;
            docs:*) echo "field=documentation ðŸ“" >> $GITHUB_ENV ;;
            chore:*) echo "field=chore ðŸ§¹" >> $GITHUB_ENV ;;
            test:*) echo "field=testing âœ…" >> $GITHUB_ENV ;;
            perf:*) echo "field=performance ðŸŽ" >> $GITHUB_ENV ;;
            style:*) echo "field=style ðŸŽ¨" >> $GITHUB_ENV ;;
            refactor:*) echo "field=refactor â™»ï¸" >> $GITHUB_ENV ;;
            ci:*) echo "field=ci/cd âš™ï¸" >> $GITHUB_ENV ;;
            build:*) echo "field=build ðŸ—ï¸" >> $GITHUB_ENV ;;
            revert:*) echo "field=revert ðŸ”„" >> $GITHUB_ENV ;;
            *) echo "field=unknown" >> $GITHUB_ENV ;; # Default case if no keyword is matched
          esac

      # Step 3: Update Project Field
      - name: Update Project Field
        uses: EndBug/project-fields@v2
        with:
          operation: set
          fields: Issue Type # Replace with your field's exact name
          github_token: ${{ secrets.PAT_SECRET }}
          project_url: https://github.com/orgs/YOUR_ORG/projects/YOUR_PROJECT_ID # Replace with your project URL
          values: ${{ env.field }}
